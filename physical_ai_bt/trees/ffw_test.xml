<?xml version="1.0" encoding="UTF-8"?>
<root BTCPP_format="3" main_tree_to_execute="RobotControlSequence">
  <BehaviorTree ID="RobotControlSequence">
    <Sequence name="RobotControlSequence">
      <UpdateTaskInstruction name="ChangeInstruction_1"
        instruction="Stay"/>
      <RuleArms name="ArmsControl_1"
        left_positions="0.75, 0.0, 0.0, -2.3, 0.0, 0.0, 0.0, 0.0"
        right_positions="0.75, 0.0, 0.0, -2.3, 0.0, 0.0, 0.0, 0.0"/>
      <RuleHeadLift name="HeadLiftControl_1"
        head_positions="0.695,0.0"
        lift_position="-0.1"/>
      <ResumeInference name="Resume_Publishing_1"/>
      <TimedInference name="VLA_Inference_1" duration="30.0"/>
      <PauseInference name="Pause_Publishing_1"/>
      <!-- <RuleArms name="ArmsControl_1"
        left_positions="0.75, 0.0, 0.0, -2.3, 0.0, 0.0, 0.0, 0.0"
        right_positions="0.75, 0.0, 0.0, -2.3, 0.0, 0.0, 0.0, 0.0"/>
      <RuleHeadLift name="HeadLiftControl_1"
        head_positions="0.695,0.0"
        lift_position="-0.1"/>
      <ResumeInference name="Resume_Publishing_1"/>
      <Inference name="VLA_Inference_1"/>
      <PauseInference name="Pause_Publishing_2"/>
      <RuleSwerve name="Rule_Based_Rotation_1" angle_deg="90.0"/>
      <UpdateTaskInstruction name="ChangeInstruction_1"
        instruction="stay"/>
      <RuleSwerve name="Rule_Based_Rotation_2" angle_deg="-90"/>
      <RuleArms name="ArmsControl_2"
        left_positions="0.75, 0.0, 0.0, -2.3, 0.0, 0.0, 0.0, 0.0"
        right_positions="0.75, 0.0, 0.0, -2.3, 0.0, 0.0, 0.0, 0.0"/>
      <RuleHeadLift name="HeadLiftControl_2"
        head_positions="0.695,0.0"
        lift_position="-0.1"/>
      <ResumeInference name="Resume_Publishing_2"/>
      <Inference name="VLA_Inference_2"/> -->
    </Sequence>
  </BehaviorTree>

  <!-- Description of Node Models (used by Groot) -->
  <TreeNodesModel>
    <Action ID="Inference"/>
    <Action ID="TimedInference">
      <input_port name="duration" default="20.0">
        Duration in seconds to run inference.
      </input_port>
    </Action>
    <Action ID="PauseInference"/>
    <Action ID="ResumeInference"/>
    <Action ID="RuleSwerve">
      <input_port name="angle_deg" default="90.0">
        Desired rotation angle in degrees.
        Positive for CCW, negative for CW.
      </input_port>
    </Action>
    <Action ID="CameraDepth">
      <input_port name="depth_topic" default="/camera/depth/image_raw">
        ROS topic for depth image (sensor_msgs/Image)
      </input_port>
    </Action>
    <Action ID="RuleHeadLift">
      <input_port name="head_positions" default="0.0,0.0">
        Target positions for head joints (comma-separated).
      </input_port>
      <input_port name="lift_position" default="0.0">
        Target position for lift joint.
      </input_port>
    </Action>
    <Action ID="RuleArms">
      <input_port name="left_positions" default="0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0">
        Target positions for left arm joints (comma-separated).
      </input_port>
      <input_port name="right_positions" default="0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0">
        Target positions for right arm joints (comma-separated).
      </input_port>
    </Action>
    <Action ID="UpdateTaskInstruction">
      <input_port name="instruction" default="">
        New task instruction to send to AI Server.
      </input_port>
    </Action>
    <Action ID="RuleLift">
      <input_port name="lift_position" default="0.0">
        Target position for lift joint.
      </input_port>
      <input_port name="position_threshold" default="0.01">
        Position tolerance for completion.
      </input_port>
    </Action>
    <Action ID="RuleGripper">
      <input_port name="closed_threshold" default="1.0">
        Threshold to detect closed gripper (>= this value).
      </input_port>
      <input_port name="open_position" default="0.0">
        Target open position for grippers.
      </input_port>
      <input_port name="position_threshold" default="0.01">
        Position tolerance for completion.
      </input_port>
    </Action>
  </TreeNodesModel>

</root>
